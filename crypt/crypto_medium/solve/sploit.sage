import json
from Crypto.Util.number import bytes_to_long, long_to_bytes

js1 = json.loads({"N": "bf9a7959c02463e56f230e8914fea3f1e4393bf3ff406a49814f92395fc9d9713fac0a6be7b59b0193595a996d6961c06f9fd00f79a4d97063f47a88110ca8e6c094f842d7252fb42c32a5f93cea3fc55ae3e89624ab1996691850fecfb43be6e97375a6dd64584431f109e5484b7c70ff8de09150411d70704a2271051743cbd5f479a60caefebc0519b4a606b8eb18235a4521781e6f33a687848f6419faa83e0c9b0b286727956ee9ef1f0eaf0c8ab339f2f575cfc89e8a88701e0388e7a9f5ab9ae39abbaf494353b9914578130e93bca4f3b1fdcf50993722c1092a782431ca37ba88ad9d65a6ce90db5aabf04f5477d9c785413bd3a3e6fe608652b813", "e": "139", "ct": "be7e8a6cfdf9f17e6af0e96ef098bcb9d951b22917a978eded91fce81f1cd29f1cdd4f8a7fda7dc3b1734ad656f40543ec232c11341532575d6fe70b41bf90f2cad917ea5a6d0e8339782ce2541be5b82adb764f6a44efe247ac93743471189e88f86b03ab00f37951ab2a5332ad498f0bfc18a733ecce6423ac129c4c8c955cefc16855ca3be3941286fd0c0c978062332e573c4ac4d1ca4356bf2c22fcf54b99f4c5d59c5ef210751feafd525fcd1b694b5dafba5d11ca7352da7532a48df84838ecfe2315fe742c8edd47bd6c9d2fbf50946de99c9d8d80adcdb29d1c22bd93d12881dc854eff853768ec7ef6be1b512ec63336ed65e281b964d1f6e01d61", "a": "ff0d4755f16e57413ec14d5dab21f9367075bd6c4c3ed1360cabaf58bcf0961aba3d13c05970260733c5ae447238d42b7014833a5ea15344929d3a64286287b116671a816d8e3f65db57f2df5c3f4890b46e9f5d97954220176d0f182e656ccdf9115e1c68ce0ec21356661fb4bb23baeab5c62aeb9e2162e3e708ed4b980cc7", "b": "2597ebc697d952c07830418d43b96ed340361b3aaf288409b8258a072f9f67e07eed088c7b6df45a0f91c232e94bb268a0c78bdb559f0fd021bcf0fb12d83c499e12d0ec0935b6ca978ea1a05f159632130e70e7637bafa72df35daa4e6dacda9d93272be4feafaafb1ca10624fbe72cc1ed91afa6356d5bb05be3707b5a7103"})
js2 = json.loads({"N": "bf9a7959c02463e56f230e8914fea3f1e4393bf3ff406a49814f92395fc9d9713fac0a6be7b59b0193595a996d6961c06f9fd00f79a4d97063f47a88110ca8e6c094f842d7252fb42c32a5f93cea3fc55ae3e89624ab1996691850fecfb43be6e97375a6dd64584431f109e5484b7c70ff8de09150411d70704a2271051743cbd5f479a60caefebc0519b4a606b8eb18235a4521781e6f33a687848f6419faa83e0c9b0b286727956ee9ef1f0eaf0c8ab339f2f575cfc89e8a88701e0388e7a9f5ab9ae39abbaf494353b9914578130e93bca4f3b1fdcf50993722c1092a782431ca37ba88ad9d65a6ce90db5aabf04f5477d9c785413bd3a3e6fe608652b813", "e": "139", "ct": "54affc09a3b79cb5edaafbdcbf650904b5f3faaa7b67473a45ad07f2feb790a56e6f314df625a849db07690ef05700b40e96d9229ba5fe7f5282a10c21bdf573367bc8871b93e92995028abaf2da5d23529048c67be91183d99f7bbe047e74b91a4d120a08e8b6989c97e845d29bd1ac7513450846f881a5f6818f07574c290595700cd8bf815a3f0ff817af2bf9e7f6618d72e944b8439d97e2875471eb2e59c3ec8e5cce384394dabc399ea18ec4a468881130fbbb2589de0550b21e3f79d8301ce22a10f000321a03dbc26c0d099c58fa360bbaa86f9b2346995531988f1eeb75f56db582344235448711a62a02cb0a984e0d7644ca896ec9cc058824044d", "a": "44d61723f52eb24ad6a6935c17d917d02eda4b802d6d57cd2024eb6ad022d83791e46f3ead8d28f77cc24df478797cefaca67d3ed3493e7968f4dfd81b374f4d41f8563d5b9487961c14f8d94c3b42da5055b8028a90dbd9d2920f081a64213ecceebbc72ca432f922056dd1fdba1a514a7cb9b6e758701f9f74b249d6ac59e1", "b": "a104a0d3061b73a66cdd0c1754e9f7fcb9b65d6b17cf66b88fb6dfa72891d33cc25c663612b301cf5ebc542b1f13bff0629bd216e734423e25421b1e8c9b3dc15e50e051e42453788419be35fb2ed976bfa624a5a1d0b3defea1e31ea674359b36ac111cf5b7ecec195276750f304fd1cc3618f3bc1d4f61e7c85579181ea011"})


def polynomial_gcd(f, g):
    if g == 0:
        return f.monic()
    else:
        return polynomial_gcd(g, f % g)


def FranklinReiter(n, e, c1, c2, a1, b1, a2, b2):
    R.<x> = PolynomialRing(Zmod(n))
    f = (a1 * x + b1) ^ e - c1
    g = (a2 * x + b2) ^ e - c2
    return int(n - polynomial_gcd(f, g).coefficients()[0])


def main():
    data1 = [js1["N"], js1["e"], js1["ct"], js1["a"], js1["b"]]
    data2 = [js2["ct"], js2["a"], js2["b"]]
    n, e, c1, a1, b1 = list(int(x, 16) for x in data1)
    c2, a2, b2 = list(int(x, 16) for x in data2)
    root = FranklinReiter(n, e, c1, c2, a1, b1, a2, b2)
    print(long_to_bytes(root))


if __name__ == "__main__":
    main()
